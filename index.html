<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NhanVat Interface - Final</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <div id="login-overlay" class="login-overlay hidden">
        <div class="login-box">
            <h2>Đăng Nhập</h2>
            <p>Vui lòng đăng nhập Google để tải tài nguyên.</p>
            <button class="google-btn" onclick="handleGoogleLogin()">
                <i class="fab fa-google"></i> Đăng nhập bằng Google
            </button>
            <button class="close-login" onclick="closeLoginPopup()">Đóng</button>
        </div>
    </div>

    <nav>
        <div class="nav-left">
            <div class="logo-circle" onclick="toggleTheme()" title="Đổi chế độ Sáng/Tối">N</div>
        </div>

        <div class="nav-container">
            <div class="nav-item active" id="btn-home" onclick="goHome()">TRANG CHỦ</div>
            
            <div id="btn-nhanvat" class="nav-item" onclick="switchCategory('NHAN_VAT')">
                NHÂN VẬT <div class="arrow-down"></div>
            </div>
            
            <div id="btn-khungcanh" class="nav-item" onclick="switchCategory('KHUNG_CANH')">
                KHUNG CẢNH <div class="arrow-down"></div>
            </div>

            <div id="btn-mauchuyendong" class="nav-item" onclick="switchCategory('MAU_CHUYEN_DONG')">
                MẪU CHUYỂN ĐỘNG <div class="arrow-down"></div>
            </div>

            <div id="btn-daocu" class="nav-item" onclick="switchCategory('DAO_CU')">
                ĐẠO CỤ <div class="arrow-down"></div>
            </div>

            <div class="nav-item">HIỆU ỨNG</div>
            <div class="nav-item">ĐỘNG VẬT</div>
            <div class="nav-item">BIỂU CẢM & CỬ CHỈ</div>
            <div class="nav-item">VẬT LIỆU MIỄN PHÍ</div>
        </div>

        <div class="nav-right">
            <div class="user-icon" id="user-display" onclick="toggleLogin()">
                <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            </div>
        </div>
    </nav>

    <div id="home-section" class="home-container">
        <h1 class="home-title">KHO TÀI NGUYÊN <br> <span>SÁNG TẠO</span></h1>
        <p class="home-subtitle">Hàng ngàn tài nguyên miễn phí: Nhân vật, Khung cảnh, Hiệu ứng...</p>
        <button class="explore-btn" onclick="switchCategory('NHAN_VAT')">KHÁM PHÁ NGAY</button>
    </div>

    <div class="container hidden" id="main-app">
        <div class="header-section">
            <a href="#" class="back-btn" onclick="goHome()">← QUAY VỀ TRANG CHỦ</a>
            <h1 class="main-title" id="page-title">NHAN<span>VAT</span></h1>
        </div>

        <div class="category-tabs" id="category-tabs"></div>

        <div class="controls-container">
            <div class="filters" id="filters"></div>
            <a href="javascript:void(0)" class="download-btn" id="download-btn" onclick="handleDownload()">
                <i class="fas fa-lock"></i> ĐĂNG NHẬP ĐỂ TẢI
            </a>
        </div>

        <div class="grid" id="grid"></div>
        <div class="pagination" id="pagination"></div>
    </div>

    <script src="data.js"></script>
    <script src="images.js"></script>

    <script type="module">
        // 1. Lấy thư viện
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        // 2. Điền mã Config MỚI NHẤT của bạn (từ ảnh image_a986ff.png)
        const firebaseConfig = {
            apiKey: "AIzaSyA72xpBaR11aAztYoP--xQ1-19Rt3mRWF8",
            authDomain: "nguyenanimate-c7bd4.firebaseapp.com",
            projectId: "nguyenanimate-c7bd4",
            storageBucket: "nguyenanimate-c7bd4.firebasestorage.app",
            messagingSenderId: "1018956225311",
            appId: "1:1018956225311:web:885a2c60a5e7ef201d6e2a"
        };

        // 3. Khởi động
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // 4. Đưa ra ngoài để script.js dùng được
        window.authServices = { auth, provider, signInWithPopup, signOut };

        // 5. Giữ đăng nhập khi F5
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log("Đã đăng nhập:", user.displayName);
                if (window.onLoginSuccess) window.onLoginSuccess(user);
            } else {
                console.log("Chưa đăng nhập");
                if (window.handleLogout) window.handleLogout(true); 
            }
        });
    </script>

    <script src="script.js"></script>

</body>
</html>
